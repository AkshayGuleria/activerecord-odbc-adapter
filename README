= OpenLink ODBC Data Adapter for Ruby on Rails

(C) 2006 OpenLink Software

21-August-06


== Status

The adapter accompanying this note is a pre-release of a Generic ODBC
Adapter for Ruby on Rails being developed by
<B>OpenLink&nbsp;Software</B>[http://www.openlinksw.com]. 

The aim of this development is to provide a single ODBC-based adapter
capable of supporting the most popular DBMSes, in contrast to the
current approach in the Rails community of each database requiring
its own adapter.

The adapter is a work-in-progress.  

It currently supports Ingres r3, Informix 9.3 or later, Oracle 10g
and OpenLink's Virtuoso
(Open&nbsp;Source&nbsp;Edition[http://virtuoso.openlinksw.com]). 

It has also been partially tested against SQL Server 2005 and MySQL
5.0, although support for these databases isn't complete at this
time.

Testing to date has been limited to the ROR 'Expenses' sample
application described at:
http://developer.apple.com/tools/rubyonrails.html 
and the ActiveRecord test modules base_test.rb and migration_test.rb
on Linux, Windows and Mac OS X using OpenLink's own ODBC drivers
and the native Virtuoso ODBC client.


== Pre-Requisites

The Rails adapter requires Christian Werner's 
Ruby&nbsp;ODBC&nbsp;Bridge[http://www.ch-werner.de/rubyodbc]
(release 0.998 or later), to bridge to an underlying ODBC driver.


== Contents

In the accompanying sources, the lib directory structure is equivalent
to the lib directory located under ACTIVE_RECORD_ROOT in your main
Ruby tree where ACTIVE_RECORD_ROOT will be something like:

    c:\ruby\lib\ruby\gems\1.8\gems\activerecord-x.y.z	    (Windows)

or:

    /usr/local/lib/ruby/gems/1.8/gems/activerecord-x.y.z    (Unix)

lib contains the files which constitute the new ODBC adapter.

test contains the fixture definitions for testing the adapter.

support/odbc_rails.diff contains some patches to ActiveRecord.

These will be submitted to the ActiveRecord source maintainer in due
course, if we request that the OpenLink ODBC Adapter for Ruby on Rails be
added to the ActiveRecord source distribution to accompany the existing
Rails adapters.

Only one patch in this diff file is really necessary - that to:

    lib/active_record/connection_adapters/abstract/schema_definitions.rb.

This fixes what appears to me to be a bug in Active Record. 

The patches to base_test.rb and migration_test.rb aren't essential.
However, they modify or bypass certain tests to cope with limitations
of particular databases. Other developers have previously modified
the tests similarly to cope with limitations of other Rails supported
databases. modified_files contains the patched versions of the files
touched by the diff file.


== Installation

To install the adapter either run install_odbc.rb e.g.

    % sudo ruby install_odbc.rb

or:

    % su
    # ruby install_odbc.rb

or perform the equivalent operations manually, as outlined below:

* Add the ODBC adapter to the list of adapters recognized by ActiveRecord.

  1. Edit ACTIVE_RECORD_ROOT/lib/active_record.rb 
      (where, on Windows, ACTIVE_RECORD_ROOT will be something like 
      c:\ruby\lib\ruby\gems\1.8\gems\activerecord-x.x.x)

  2. Edit the line:

        RAILS_CONNECTION_ADAPTERS = %w( mysql postgresql sqlite firebird sqlserver db2 oracle sybase openbase)

     to include odbc as an adapter, i.e.

        RAILS_CONNECTION_ADAPTERS = %w( mysql postgresql ... openbase odbc)

* Copy odbc_adapter.rb to the ACTIVE_RECORD_ROOT/lib/active_record/connection_adapters directory

* Copy the odbcext_*.rb files to the ACTIVE_RECORD_ROOT/lib/active_record/vendor directory


== Configuring the Adapter

Examples of the required connection parameters can be found in

   test/connections/native_odbc/connection.rb

If you enable call tracing by setting :trace => true,  specify the
logger output file as illustrated in connection.rb, e.g.

    ActiveRecord::Base.logger = Logger.new("debug_odbc.log")

== License

The OpenLink ODBC Adapter for Ruby on Rails is released under the MIT license
(See COPYING).
